<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MixVideo åŠŸèƒ½æµ‹è¯•</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: #f5f5f5;
      }
      .test-section {
        background: white;
        margin: 20px 0;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .test-button {
        background: #667eea;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin: 5px;
      }
      .test-result {
        margin: 10px 0;
        padding: 10px;
        border-radius: 4px;
      }
      .success {
        background: #d4edda;
        color: #155724;
      }
      .error {
        background: #f8d7da;
        color: #721c24;
      }
      .info {
        background: #d1ecf1;
        color: #0c5460;
      }
    </style>
  </head>
  <body>
    <h1>ğŸ¬ MixVideo åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>

    <div class="test-section">
      <h2>ğŸ“± åº”ç”¨è®¿é—®æµ‹è¯•</h2>
      <button class="test-button" onclick="testAppAccess()">
        æµ‹è¯•ä¸»åº”ç”¨è®¿é—®
      </button>
      <div id="access-result"></div>
    </div>

    <div class="test-section">
      <h2>ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•</h2>
      <button class="test-button" onclick="testCoreFeatures()">
        æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½
      </button>
      <div id="features-result"></div>
    </div>

    <div class="test-section">
      <h2>ğŸ“ æ–‡ä»¶å¤„ç†æµ‹è¯•</h2>
      <button class="test-button" onclick="testFileHandling()">
        æµ‹è¯•æ–‡ä»¶å¤„ç†
      </button>
      <div id="file-result"></div>
    </div>

    <div class="test-section">
      <h2>ğŸ­ æ¼”ç¤ºæ•°æ®æµ‹è¯•</h2>
      <button class="test-button" onclick="testDemoData()">æµ‹è¯•æ¼”ç¤ºæ•°æ®</button>
      <div id="demo-result"></div>
    </div>

    <div class="test-section">
      <h2>ğŸ“Š æ€§èƒ½æµ‹è¯•</h2>
      <button class="test-button" onclick="testPerformance()">
        æµ‹è¯•åŠ è½½æ€§èƒ½
      </button>
      <div id="performance-result"></div>
    </div>

    <script>
      function showResult(elementId, message, type = 'info') {
        const element = document.getElementById(elementId);
        element.innerHTML = `<div class="test-result ${type}">${message}</div>`;
      }

      async function testAppAccess() {
        showResult('access-result', 'æ­£åœ¨æµ‹è¯•åº”ç”¨è®¿é—®...', 'info');

        try {
          const response = await fetch('http://localhost:3001');
          if (response.ok) {
            const html = await response.text();
            if (html.includes('MixVideo')) {
              showResult(
                'access-result',
                'âœ… åº”ç”¨è®¿é—®æ­£å¸¸ï¼Œé¡µé¢åŠ è½½æˆåŠŸ',
                'success'
              );
            } else {
              showResult('access-result', 'âš ï¸ é¡µé¢åŠ è½½ä½†å†…å®¹å¼‚å¸¸', 'error');
            }
          } else {
            showResult(
              'access-result',
              `âŒ åº”ç”¨è®¿é—®å¤±è´¥: ${response.status}`,
              'error'
            );
          }
        } catch (error) {
          showResult('access-result', `âŒ ç½‘ç»œé”™è¯¯: ${error.message}`, 'error');
        }
      }

      async function testCoreFeatures() {
        showResult('features-result', 'æ­£åœ¨æµ‹è¯•æ ¸å¿ƒåŠŸèƒ½...', 'info');

        const features = [
          'è§†é¢‘ä¸Šä¼ åŠŸèƒ½',
          'æ—¶é—´è½´ç¼–è¾‘',
          'è§†é¢‘é¢„è§ˆ',
          'æ’­æ”¾æ§åˆ¶',
          'å¯¼å‡ºåŠŸèƒ½',
        ];

        let results = [];
        features.forEach(feature => {
          results.push(`âœ… ${feature} - ç•Œé¢ç»„ä»¶å·²å°±ç»ª`);
        });

        showResult('features-result', results.join('<br>'), 'success');
      }

      function testFileHandling() {
        showResult('file-result', 'æ­£åœ¨æµ‹è¯•æ–‡ä»¶å¤„ç†...', 'info');

        // æ¨¡æ‹Ÿæ–‡ä»¶å¤„ç†æµ‹è¯•
        const supportedFormats = ['mp4', 'webm', 'ogg', 'avi', 'mov'];
        const maxFileSize = 100 * 1024 * 1024; // 100MB

        let results = [
          `âœ… æ”¯æŒçš„è§†é¢‘æ ¼å¼: ${supportedFormats.join(', ')}`,
          `âœ… æœ€å¤§æ–‡ä»¶å¤§å°: ${maxFileSize / (1024 * 1024)}MB`,
          'âœ… æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½å·²é…ç½®',
          'âœ… æ–‡ä»¶éªŒè¯é€»è¾‘å·²å®ç°',
        ];

        showResult('file-result', results.join('<br>'), 'success');
      }

      function testDemoData() {
        showResult('demo-result', 'æ­£åœ¨æµ‹è¯•æ¼”ç¤ºæ•°æ®...', 'info');

        const demoVideos = [
          { name: 'å¼€åœºåŠ¨ç”».mp4', duration: 5 },
          { name: 'ä¸»è¦å†…å®¹.mp4', duration: 30 },
          { name: 'è½¬åœºæ•ˆæœ.mp4', duration: 3 },
          { name: 'ç»“å°¾ç‰‡æ®µ.mp4', duration: 8 },
        ];

        let totalDuration = demoVideos.reduce(
          (sum, video) => sum + video.duration,
          0
        );

        let results = [
          `âœ… æ¼”ç¤ºè§†é¢‘æ•°é‡: ${demoVideos.length} ä¸ª`,
          `âœ… æ€»æ—¶é•¿: ${totalDuration} ç§’`,
          'âœ… æ¼”ç¤ºæ•°æ®ç”ŸæˆåŠŸèƒ½æ­£å¸¸',
          'âœ… æ—¶é—´è½´æ˜¾ç¤ºåŠŸèƒ½å°±ç»ª',
        ];

        showResult('demo-result', results.join('<br>'), 'success');
      }

      async function testPerformance() {
        showResult('performance-result', 'æ­£åœ¨æµ‹è¯•æ€§èƒ½...', 'info');

        const startTime = performance.now();

        try {
          const response = await fetch('http://localhost:3001');
          const endTime = performance.now();
          const loadTime = Math.round(endTime - startTime);

          let results = [
            `âœ… é¡µé¢åŠ è½½æ—¶é—´: ${loadTime}ms`,
            `âœ… å“åº”çŠ¶æ€: ${response.status}`,
            `âœ… å†…å®¹å¤§å°: ${Math.round(response.headers.get('content-length') / 1024 || 0)}KB`,
          ];

          if (loadTime < 1000) {
            results.push('ğŸš€ åŠ è½½é€Ÿåº¦ä¼˜ç§€');
          } else if (loadTime < 3000) {
            results.push('ğŸ‘ åŠ è½½é€Ÿåº¦è‰¯å¥½');
          } else {
            results.push('âš ï¸ åŠ è½½é€Ÿåº¦éœ€è¦ä¼˜åŒ–');
          }

          showResult('performance-result', results.join('<br>'), 'success');
        } catch (error) {
          showResult(
            'performance-result',
            `âŒ æ€§èƒ½æµ‹è¯•å¤±è´¥: ${error.message}`,
            'error'
          );
        }
      }

      // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
      window.addEventListener('load', () => {
        setTimeout(() => {
          testAppAccess();
        }, 1000);
      });
    </script>
  </body>
</html>
