# GUI界面Tab和批量处理功能说明

## 🎯 **新增功能概述**

为 shot_detection 项目的 GUI 界面添加了 **Tab 标签页** 和 **批量处理** 功能，使界面更加简洁易用，同时支持批量处理多个视频文件。

## 📋 **主要改进**

### 1. **Tab 标签页界面**
- **单个文件处理** Tab：处理单个视频文件
- **批量处理** Tab：批量处理多个视频文件
- **共享进度区域**：两个Tab共享同一个进度显示和日志区域

### 2. **简化的界面设计**
- 移除了复杂的滚动区域
- 简化了设置选项，只保留核心功能
- 优化了布局，提高了用户体验

### 3. **批量处理功能**
- 支持选择输入目录和输出目录
- 支持递归搜索子目录中的视频文件
- 支持多种视频格式：MP4, AVI, MOV, MKV, WMV, FLV, WebM, M4V
- 实时显示批量处理进度和结果统计

## 🖥️ **界面结构**

```
🎬 智能镜头检测与分段系统
├── 📄 单个文件处理 Tab
│   ├── 📁 文件选择区域
│   │   ├── 视频文件选择
│   │   └── 输出目录选择
│   ├── ⚙️ 处理设置
│   │   └── 输出质量选择
│   └── 🚀 控制按钮
│       ├── 开始处理
│       └── 停止处理
├── 📁 批量处理 Tab
│   ├── 📁 批量文件选择区域
│   │   ├── 输入目录选择
│   │   ├── 输出目录选择
│   │   └── 包含子目录选项
│   ├── ⚙️ 批量处理设置
│   │   └── 输出质量选择
│   └── 🚀 批量控制按钮
│       ├── 开始批量处理
│       └── 停止处理
└── 📊 共享进度区域
    ├── 进度条
    ├── 状态标签
    └── 日志文本框
```

## 🔧 **核心功能**

### **单个文件处理**
- 选择单个视频文件进行镜头检测和分段
- 自动设置输出目录（基于视频文件名）
- 支持三种质量模式：low, medium, high
- 实时显示处理进度和日志

### **批量处理**
- 选择包含多个视频文件的目录
- 支持递归搜索子目录
- 自动为每个视频文件创建独立的输出目录
- 显示批量处理统计信息（成功/失败/总计）

## 📁 **文件说明**

### **主要文件**
- `gui_app.py` - 完整版GUI（包含所有功能）
- `gui_test.py` - 测试版GUI（用于验证界面结构）

### **新增变量**
```python
# 批量处理变量
self.batch_input_dir = tk.StringVar()      # 批量输入目录
self.batch_output_dir = tk.StringVar()     # 批量输出目录
self.batch_quality_mode = tk.StringVar()   # 批量处理质量
self.batch_recursive = tk.BooleanVar()     # 是否递归搜索
```

### **新增方法**
```python
# 界面创建方法
create_single_file_interface()     # 创建单个文件处理界面
create_batch_interface()           # 创建批量处理界面
create_shared_progress_section()   # 创建共享进度区域

# 批量处理方法
browse_batch_input_dir()           # 浏览批量输入目录
browse_batch_output_dir()          # 浏览批量输出目录
start_batch_processing()           # 开始批量处理
_batch_processing_worker()         # 批量处理工作线程
_finish_batch_processing()         # 完成批量处理
open_batch_output_directory()      # 打开批量输出目录
validate_batch_inputs()            # 验证批量处理输入
```

## 🚀 **使用方法**

### **单个文件处理**
1. 切换到 "📄 单个文件处理" Tab
2. 点击"浏览"选择视频文件
3. 选择输出目录（可自动设置）
4. 选择输出质量
5. 点击"🚀 开始处理"

### **批量处理**
1. 切换到 "📁 批量处理" Tab
2. 选择包含视频文件的输入目录
3. 选择批量输出目录
4. 勾选"包含子目录"（如需要）
5. 选择输出质量
6. 点击"🚀 开始批量处理"

## 📊 **批量处理逻辑**

1. **文件发现**：扫描输入目录，查找所有支持的视频文件
2. **目录创建**：为每个视频文件创建独立的输出目录
3. **逐个处理**：按顺序处理每个视频文件
4. **进度更新**：实时更新整体进度和当前处理状态
5. **结果统计**：显示成功/失败/总计的处理结果

## 🎨 **界面优化**

- **简洁设计**：移除了复杂的归类功能设置
- **Tab分离**：将单个文件和批量处理分开，避免界面混乱
- **共享资源**：进度显示和日志区域共享，节省界面空间
- **智能默认**：自动设置合理的默认输出目录

## 🔄 **向后兼容**

- 保持了原有的单个文件处理功能
- 保留了核心的视频处理逻辑
- 维持了原有的配置和设置选项

## 🧪 **测试建议**

1. 使用 `gui_test.py` 验证界面布局和交互
2. 测试单个文件处理功能
3. 测试批量处理功能（建议先用少量文件测试）
4. 验证递归搜索功能
5. 测试停止处理功能

这个新的Tab界面设计使得 shot_detection 工具更加用户友好，特别是对于需要处理大量视频文件的用户来说，批量处理功能将大大提高工作效率。
